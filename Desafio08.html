<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Gabriel Belchior">

<title>Desafio08</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Desafio08_files/libs/clipboard/clipboard.min.js"></script>
<script src="Desafio08_files/libs/quarto-html/quarto.js"></script>
<script src="Desafio08_files/libs/quarto-html/popper.min.js"></script>
<script src="Desafio08_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Desafio08_files/libs/quarto-html/anchor.min.js"></script>
<link href="Desafio08_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Desafio08_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Desafio08_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Desafio08_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Desafio08_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Desafio08</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Gabriel Belchior </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RSQLite)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: pacote 'RSQLite' foi compilado no R versão 4.4.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Conectar</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>conn <span class="ot">&lt;-</span> <span class="fu">dbConnect</span>(<span class="fu">SQLite</span>(), <span class="st">"database.sqlite3"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Consulta para obter a lista de professores de 'STAT'</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>query_lista_professores <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT DISTINCT</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="st">  T6.name AS professor_name</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="st">FROM</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="st">  subjects AS T1</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="st">  INNER JOIN subject_memberships AS T2 ON T1.code = T2.subject_code</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="st">  INNER JOIN course_offerings AS T3 ON T2.course_offering_uuid = T3.uuid</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="st">  INNER JOIN sections AS T4 ON T3.uuid = T4.course_offering_uuid</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="st">  INNER JOIN teachings AS T5 ON T4.uuid = T5.section_uuid</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="st">  INNER JOIN instructors AS T6 ON T5.instructor_id = T6.id</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="st">  T1.abbreviation = 'STAT'</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="st">  T6.name;</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Execute a consulta e armazene o resultado em um dataframe</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>lista_professores_stat <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(conn, query_lista_professores)</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Exiba a lista de professores</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(lista_professores_stat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   professor_name
1                 ABIGAIL BENZINE
2            ADIN-CRISTIAN ANDREI
3                  AKICHIKA OZEKI
4                      ALAN HUANG
5                 ALBERTO DEL PIA
6                  ALBRECHT KLEMM
7             ALEXANDER COVINGTON
8                  ALEXANDER FISH
9               ALEXANDER KISELEV
10                 ALYSSA DIGILIO
11                   ANATOLE BECK
12                  ANDREJ ZLATOS
13                  ANDREW LESLIE
14                  ANNE BRUCKNER
15                       ANQI SHI
16                     ANRU ZHANG
17                  ARNOLD MILLER
18                  AUGUST JENSEN
19                 BEHZAD AALIPUR
20      BEHZAD AALIPUR HAFSHEJANI
21               BEN ADAM HAALAND
22                  BENEDEK VALKO
23                 BENJAMIN RECHT
24                    BI CHENG WU
25                        BIN DAI
26                      BIN ZHANG
27                        BIN ZHU
28                   BINGYING XIE
29                       BO HUANG
30                        BO YANG
31                       BOWEN HU
32                    BRET HANLON
33                    BRET LARGET
34                  BRIAN YANDELL
35                    BROOK LUERS
36                     CECILE ANE
37                      CHAN PARK
38                    CHANHAN HSU
39                    CHAOQUN MEI
40                    CHAOYANG YU
41                  CHELSEY GREEN
42                     CHEN CHENG
43                      CHEN JING
44                CHENGNING ZHANG
45                   CHENLIANG XU
46                CHENSHENG KUANG
47                      CHENXI LI
48                 CHIA-CHIEH LIN
49                 CHIEN-WEI CHEN
50       CHRISTINA M. KENDZIORSKI
51             CHRISTINE SORKNESS
52             CHRISTOPHER WAGNER
53                   CLAIRE BOBST
54            CLAUDIA SOLIS LEMUS
55                      COLE COOK
56                COLIN LONGHURST
57                   CRYSTAL CHEN
58                      CUICUI QI
59                      CUIZE HAN
60            DANIELE CAPPELLETTI
61                 DAVID ANDERSON
62                   DAVID DEMETS
63                DAVID GRIFFEATH
64                     DEBRAJ DAS
65                     DEREK BEAN
66                   DEREK NORTON
67                   DEYUAN JIANG
68            DIETRICH UHLENBROCK
69                  DONALD PORTER
70                       DONG XIA
71                    DONGGYU KIM
72                   DONGHYUN LEE
73               DOUGLAS M. BATES
74                     DUY NGUYEN
75                     DUZHE WANG
76                   EDWARD ERKER
77                ELOISA D CHAVAS
78              ERICA LEE DEADMAN
79                  ERIK NORDHEIM
80                        FAN GAO
81                       FAN YANG
82                      FANG FANG
83                  FANGFANG WANG
84               FLORIAN BERTRAND
85                FREDERICK BOEHM
86               GARVESH RASKUTTI
87          GARY HOWARD SCHROEDER
88                        GENG LI
89                 GINA BENNINGER
90                        GINA OH
91               GONZALO CONTADOR
92                    GRACE WAHBA
93         GREGORIO MORENO-FLORES
94               GREGORY SHINAULT
95                   GUANHUA CHEN
96                    GUANNAN SUN
97                 GUILHERME ROSA
98  GUILHERME VIEIRA NUNES LUDWIG
99                 GUN WOONG PARK
100                      HAN CHEN
101                      HAO CHEN
102                      HAO TENG
103                     HAO ZHENG
104                      HAO ZHOU
105                      HAODA FU
106                   HAOYANG FAN
107         HEATHER MARIE BRAZEAU
108                  HUAIBAO FENG
109                      HUI WANG
110                  HUIKUN ZHANG
111                     HUILIN HU
112                   HYEBIN SONG
113                HYUNSEUNG KANG
114            IAN BRANSTAD RILEY
115                 ISMOR FISCHER
116                JAMES ANDERSON
117                JAMES D KUELBS
118                   JARED BROWN
119                  JASON P FINE
120         JASON RICHARD SWANSON
121                  JEE YEON KIM
122                     JEEA CHOI
123             JENNIFER BIRSTLER
124               JENNIFER NGUYEN
125           JESSE THOMAS HOLZER
126                   JIAJIE CHEN
127                      JIALE XU
128                       JIAN WU
129                  JIANCHANG HU
130                      JIE SONG
131                       JIE WEI
132                     JIE ZHANG
133                     JILI WANG
134                   JINGCI MENG
135                JINGJIANG PENG
136                    JINGLAN LI
137                    JIWEI ZHAO
138                    JOHN DAVIS
139                  JOHN GILLETT
140                     JOHN KANE
141         JOHN WILTSHIRE-GORDON
142             JONATHON PETERSON
143                 JOSEP GINEBRA
144                JOSEPH DEUTSCH
145                    JU HEE CHO
146                        JUN LI
147                      JUN SHAO
148                       JUN YIN
149                     JUN ZHANG
150                       JUN ZHU
151                   JUNGWON MUN
152                    JUNHEE HAN
153                     JUNHO LEE
154                   KAILEI CHEN
155                  KAM-WAH TSUI
156                   KARL BROMAN
157                     KARL ROHE
158               KATHERINE GOODE
159               KAZUHIKO SHINKI
160              KEEGAN KORTHAUER
161                       KEN ONO
162            KEVIN HASEGAWA ENG
163                 KEVIN PACKARD
164                  KJELL DOKSUM
165  KRISHNAKUMAR BALASUBRAMANIAN
166                KRISTEN CYFFKA
167                 KUNLING HUANG
168                   KYLE HEBERT
169                   KYLE HERBET
170                 KYUNGMANN KIM
171                        LAM HO
172                       LAN LUO
173                LANCINE KONATE
174                        LEI XU
175                   LEV BORISOV
176                 LIAM JOHNSTON
177                     LIE XIONG
178                      LILI LAN
179                    LILI ZHENG
180                      LILUN DU
181                        LIN QI
182                     LONG PHAN
183                        LU MAO
184                       LU YANG
185                   LUWAN ZHANG
186                      LUXI CAO
187            MANJUSHA KANCHARLA
188                    MARI PALTA
189              MARIA KAMENETSKY
190                    MARIA ROJO
191               MARIAN R FISHER
192                MARY LINDSTROM
193               MATTHEW BALLARD
194                     MENG SONG
195                MICHAEL FERRIS
196          MICHAEL GEORGE ILTIS
197                 MICHAEL HOGAN
198               MICHAEL KUTZLER
199                  MICHAEL LIOU
200                MICHAEL NEWTON
201          MICHAEL RENE KOSOROK
202               MICHELLE HARRIS
203                 MIHAELA IFRIM
204                  MIN JUNG LEE
205                       MIN NIU
206                      MING XIE
207                     MING YUAN
208                   MINJING TAO
209              MITCHELL PAUKNER
210                   MOO K CHUNG
211                    MUHONG GAO
212                MURRAY CLAYTON
213         NATALIA DE LEON GATTI
214               NELLIE LAUGHLIN
215            NICHOLAS HENDERSON
216       NICHOLAS STEPHEN KEULER
217                      NING FAN
218            NORBERT BINKIEWICZ
219                 NORMAN DRAPER
220            PAUL M TERWILLIGER
221                  PAUL RATHOUZ
222              PAUL SAVARIAPPAN
223                   PEIGEN ZHOU
224                   PERLA REYES
225                   PHILIP WOOD
226                      QI JIANG
227                       QI TANG
228                 QIAN ZHIGUANG
229                       QING LI
230                   QIONG ZHANG
231                   QIURONG CUI
232                    QUEFENG LI
233                     QUOC TRAN
234                REBECCA KOSCIK
235                  REBECCA POST
236             RICHARD A BRUALDI
237            RICHARD A. JOHNSON
238           RICHARD J. CHAPPELL
239                 ROBERT HARRON
240                ROBERT R MEYER
241                ROBERT WARDROP
242            ROBERT WAYNE GREEN
243                RONALD GANGNON
244                   RONGJUN ZHU
245                      RUI CHEN
246                      RUI TANG
247                  RUIFANG SONG
248                    RUIFENG XU
249                   RUNGANG HAN
250                     RUOSI GUO
251                      RYAN ZEA
252              SAMUEL STECHMANN
253                  SANGBUM CHOI
254                 SCOTT HOTTOVY
255           SCOTT JOSEPH HETZEL
256                     SEAN KENT
257                SEBASTIEN ROCH
258                     SEHO PARK
259                   SEULKEE YUN
260                 SEUNGBONG HAN
261                       SHAN LU
262                  SHANE HUBLER
263                      SHANG WU
264                    SHENG WANG
265                   SHENG ZHANG
266                   SHENGJI JIA
267                       SHI JIN
268                    SHIXUE LIU
269                  SHIZHEN WANG
270                    SHUAI CHEN
271                  SHUANG HUANG
272                   SHULEI WANG
273                     SHUYUN YE
274                   SIJIAN WANG
275                     SIJING LI
276                SOHEIL SADEGHI
277                    SOKOL VAKO
278                SONA Z SWANSON
279                     SONG WANG
280  SRIKANTHMADHAVAN ARAVAMUTHAN
281                 STEFFEN LEMPP
282        STEPHEN AARON STANHOPE
283                  STEPHEN BERG
284               STEPHEN WAINGER
285                STEPHEN WRIGHT
286                    STEVEN SAM
287             SUKHENDU MEHROTRA
288                  SUNDUZ KELES
289                     TAERI UHM
290                        TAO YU
291       THEVAASIINEN CHANDERENG
292                   THOMAS COOK
293               THOMAS G. KURTZ
294                        THU LE
295                       TIEN VO
296              TIMO SEPPALAINEN
297                 TIMOTHY IDOWU
298                       TING YE
299                   TING-LI LIN
300                       TONG LI
301                  TONGHAI YANG
302                       TRAM TA
303                    TUN LEE NG
304               TZU HSIANG HUNG
305               VARSHA KULKARNI
306                    VICTOR LUO
307            VICTORIA MANSFIELD
308                  WAI TONG FAN
309                     WEI ZHENG
310                   WEI-YIN LOH
311                  WENWEN ZHANG
312                    WENZHI CAO
313                  WESLEY CHANG
314                      XIAO GUO
315                      XIAO NIE
316                   XIAODAN WEI
317                    XIAOMAO LI
318                 XIAOPING FENG
319                    XIAOWU DAI
320                        XIN LI
321                     XIN ZHANG
322                     XINJIE HE
323                   XINWEI DENG
324                     XINXIN YU
325                    XINYU SONG
326                    XIPEI YANG
327                    XIRAN WANG
328                  XIUFENG SHAO
329                      XIUYU MA
330                      XIWEN MA
331                         XU HE
332                         XU XU
333                   XUEYAO CHEN
334                      XUN ZHAO
335                     YAJUAN SI
336                     YALI WANG
337                      YAN CHEN
338                 YANBING ZHENG
339                     YANG ZHAO
340                    YANNAN QIU
341                    YAOGUO XIE
342                     YAOYAO XU
343                   YAZHEN WANG
344                       YI CHAI
345                         YI LI
346                        YI LIU
347                     YIFAN MEI
348                   YILIN ZHANG
349                    YING ZHANG
350                   YONGFENG WU
351                  YONGJOON KIM
352                    YONGSU LEE
353                     YOUNG LEE
354                YOUNG MIN PARK
355               YOUNGDEOK HWANG
356                     YOURAN QI
357                   YU MENGGANG
358                    YU QIU LIU
359                    YUAN JIANG
360                       YUAN LI
361                     YUAN WANG
362                    YUANZHI LI
363                    YUCHANG WU
364                   YUCHEN ZHOU
365                   YUJIN CHUNG
366                    YUNONG LIN
367                     YUQING XU
368                ZHANG CHUNMING
369                ZHENGJUN ZHANG
370                  ZHENGXIAO WU
371                  ZHIGENG GENG
372                   ZHIGUO XIAO
373                   ZHONGJIE YU
374                     ZHUANG WU
375                   ZIFENG ZHAO
376                     ZIJIAN NI
377                 ZUOFENG SHANG</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Para saber a quantidade, você pode usar a função nrow() no R</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Total de professores de 'STAT':"</span>, <span class="fu">nrow</span>(lista_professores_stat), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Total de professores de 'STAT': 377 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Consulta para calcular o GPA de cada oferecimento e associar a professor e disciplina</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>query_gpa <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="st">WITH GradePoints AS (</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="st">    T1.course_offering_uuid,</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="st">    CAST(SUM((4.0 * T1.a_count) + (3.5 * T1.ab_count) + (3.0 * T1.b_count) + (2.5 * T1.bc_count) + (2.0 * T1.c_count) + (1.0 * T1.d_count) + (0.0 * T1.f_count)) AS REAL) AS total_points,</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="st">    CAST(SUM(T1.a_count + T1.ab_count + T1.b_count + T1.bc_count + T1.c_count + T1.d_count + T1.f_count) AS REAL) AS total_students</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="st">  FROM</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="st">    grade_distributions AS T1</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="st">  INNER JOIN</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="st">    course_offerings AS T2 ON T1.course_offering_uuid = T2.uuid</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="st">  INNER JOIN</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="st">    subject_memberships AS T3 ON T2.uuid = T3.course_offering_uuid</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="st">  INNER JOIN</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="st">    subjects AS T4 ON T3.subject_code = T4.code</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="st">  WHERE</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="st">    T4.abbreviation = 'STAT'</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="st">  GROUP BY</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="st">    T1.course_offering_uuid</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="st">)</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a><span class="st">    T5.name AS professor_name,</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a><span class="st">    T6.name AS course_name,</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a><span class="st">    (T1.total_points / T1.total_students) AS gpa</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a><span class="st">FROM</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a><span class="st">    GradePoints AS T1</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a><span class="st">INNER JOIN</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a><span class="st">    course_offerings AS T2 ON T1.course_offering_uuid = T2.uuid</span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a><span class="st">INNER JOIN</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a><span class="st">    sections AS T3 ON T2.uuid = T3.course_offering_uuid</span></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a><span class="st">INNER JOIN</span></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a><span class="st">    teachings AS T4 ON T3.uuid = T4.section_uuid</span></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a><span class="st">INNER JOIN</span></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a><span class="st">    instructors AS T5 ON T4.instructor_id = T5.id</span></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a><span class="st">INNER JOIN</span></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a><span class="st">    courses AS T6 ON T2.course_uuid = T6.uuid</span></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE</span></span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a><span class="st">    T1.total_students &gt; 0;</span></span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Execute a consulta e armazene o resultado em um dataframe</span></span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>gpa_data <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(conn, query_gpa)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcule o GPA médio para cada professor usando aggregate()</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>professor_gpa <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(gpa <span class="sc">~</span> professor_name, <span class="at">data =</span> gpa_data, <span class="at">FUN =</span> mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Ordene o dataframe pelo GPA médio em ordem crescente</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>professor_gpa_ordenado <span class="ot">&lt;-</span> professor_gpa[<span class="fu">order</span>(professor_gpa<span class="sc">$</span>gpa), ]</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Professor mais difícil (o primeiro da lista ordenada)</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>professor_mais_dificil <span class="ot">&lt;-</span> <span class="fu">head</span>(professor_gpa_ordenado, <span class="dv">1</span>)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Professor mais fácil (o último da lista ordenada)</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>professor_mais_facil <span class="ot">&lt;-</span> <span class="fu">tail</span>(professor_gpa_ordenado, <span class="dv">1</span>)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Professor mais difícil:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Professor mais difícil:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(professor_mais_dificil)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    professor_name      gpa
115 JAMES D KUELBS 2.607692</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Professor mais fácil:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Professor mais fácil:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(professor_mais_facil)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    professor_name gpa
330      YAJUAN SI   4</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcule o GPA médio para cada disciplina</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>disciplina_gpa <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(gpa <span class="sc">~</span> course_name, <span class="at">data =</span> gpa_data, <span class="at">FUN =</span> mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Ordene o dataframe pelo GPA médio em ordem crescente</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>disciplina_gpa_ordenada <span class="ot">&lt;-</span> disciplina_gpa[<span class="fu">order</span>(disciplina_gpa<span class="sc">$</span>gpa), ]</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Disciplina mais difícil (a primeira da lista ordenada)</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>disciplina_mais_dificil <span class="ot">&lt;-</span> <span class="fu">head</span>(disciplina_gpa_ordenada, <span class="dv">1</span>)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Disciplina mais fácil (a última da lista ordenada)</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>disciplina_mais_facil <span class="ot">&lt;-</span> <span class="fu">tail</span>(disciplina_gpa_ordenada, <span class="dv">1</span>)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Disciplina mais difícil:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Disciplina mais difícil:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(disciplina_mais_dificil)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                 course_name      gpa
26 Introduction to the Theory of Probability 2.890992</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Disciplina mais fácil:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Disciplina mais fácil:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(disciplina_mais_facil)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                       course_name gpa
45 Sample Survey Theory and Method   4</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbDisconnect</span>(conn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Este documento foi gerado em 24 de setembro de 2025, 22:08.</p>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>